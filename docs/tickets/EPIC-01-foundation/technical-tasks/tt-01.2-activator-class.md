# TT-01.2: Create Activator Class

**Ticket ID:** TT-01.2
**Ticket Type:** Technical Task
**Epic:** EPIC-01
**Priority:** P0
**Estimated Time:** 1.5 hours
**Status:** Not Started
**Blockers:** None

---

## Description

Create the GAP_Activator class to handle plugin activation and deactivation lifecycle events. This class will contain static methods for activation and deactivation hooks, ensuring proper plugin initialization and cleanup.

The activator will flush rewrite rules and save the plugin version on activation, and flush rewrite rules on deactivation while preserving all plugin data.

---

## Implementation Steps

1. Add ABSPATH security check
2. Create GAP_Activator class
3. Implement activate() method
4. Implement deactivate() method
5. Add inline documentation
6. Test activation/deactivation

---

## Security Checks

- ABSPATH defined check
- User capability checks (if needed)
- Nonce verification (if needed)

---

## Activation Tasks

- Flush rewrite rules
- Set plugin version option
- Create any necessary database tables (not needed for v1.0)

---

## Deactivation Tasks

- Flush rewrite rules
- DO NOT delete data (data persists after deactivation)

---

## Code Structure

```php
<?php
/**
 * Plugin Activator
 *
 * Handles plugin activation and deactivation.
 *
 * @package GA_Plugin
 * @since 1.0.0
 */

// Prevent direct access
if (!defined('ABSPATH')) {
    exit;
}

/**
 * Class GAP_Activator
 *
 * Handles plugin activation and deactivation hooks.
 */
class GAP_Activator {

    /**
     * Plugin activation
     *
     * Runs when the plugin is activated.
     * Flushes rewrite rules and saves plugin version.
     *
     * @since 1.0.0
     */
    public static function activate() {
        // Flush rewrite rules to ensure CPT permalinks work
        flush_rewrite_rules();

        // Save plugin version to options for future upgrades
        update_option('gap_version', GAP_VERSION);

        // Save activation timestamp
        update_option('gap_activated', current_time('timestamp'));
    }

    /**
     * Plugin deactivation
     *
     * Runs when the plugin is deactivated.
     * Flushes rewrite rules but preserves all data.
     *
     * @since 1.0.0
     */
    public static function deactivate() {
        // Flush rewrite rules to clean up CPT permalinks
        flush_rewrite_rules();

        // DO NOT delete any data - data should only be removed on uninstall
    }
}
```

---

## Definition of Done

- [ ] GAP_Activator class file created at includes/class-gap-activator.php
- [ ] ABSPATH security check added
- [ ] Class properly documented with docblock
- [ ] activate() static method implemented
- [ ] activate() flushes rewrite rules
- [ ] activate() saves plugin version to options
- [ ] activate() saves activation timestamp
- [ ] activate() method documented with docblock
- [ ] deactivate() static method implemented
- [ ] deactivate() flushes rewrite rules
- [ ] deactivate() does NOT delete any data
- [ ] deactivate() method documented with docblock
- [ ] Code follows WordPress coding standards
- [ ] Manual testing completed (activate/deactivate/reactivate cycle)
- [ ] Verify options are saved on activation
- [ ] Verify options persist after deactivation
- [ ] Code review completed
- [ ] Committed to version control

---

**Created:** 2025-10-16
**Last Updated:** 2025-10-16
